# My-config-prettier-eslint-husky
Всем привет, здесь выложен мой конфиг для code style

В папке Regular version вы найдете конфиг для проектов на React без Typescript
В папке With typescript вы найдете конфиг для проектов на React с Typescript

В папках лежит 5 файла 
 1. .eslintrc.js
 2. .prettierrc
 3. pre-commit - который используется husky
 4. package.json
 5. jsconfig.json || tsconfig.json - нужны для корректной работы всего конфига

 ## Я дам объянения по каждому файлу и затрону интересные моменты

 -------------------------
### Первое с чего мы начнем это файл .prettierrc

Это файл отвечает за вашу конфигурацию prettier в вашем проекте. Здесь прописаны основные правила, которые обычно везде одинаковые.
Такие как одинарные или двойные кавычки, длина строки, количество отступов. Но есть одно интересное под названием endOfLine. 
На которое вам нужно обратить внимание. Это правило определяет окончание строки и там есть 4 параметра ( "auto", "cr", "crlf", "lf" ) 
Это правило отличается тем что на разных платформах работает не так как вы указали. А конкретно это касается linux и mac os их особеность в том что они поддрежывают только окончание "lf", и даже если вы выставите другие параметры все равно будете получать в git diff полный файл измененый, поэтому придется выставлять значения в "lf" и так же пройти эти инструкции от prettier https://prettier.io/docs/en/options.html#end-of-line. Такова реальность разработки, но это единственное что вам нужно учесть в своем конфиге prettier.

 ------------------------
### Второй пункт .eslintrc.js


Это файл отвечает за вашу конфигурацию eslint. Тут я использую ряд расширений такие как airbnb, unicorn, ( eslint-plugin-jsx-a11y у меня его нету в файле, он идет с коробки у airbnb ). И так же плагин для сортировки импортов simple-import-sort. Вам нужно учитывать важную деталь при добавлении extends что порядок играет роль, потому что набор правил расширяет или перезаписывает предыдущие. Более подробно расписано здесь https://stackoverflow.com/questions/46544082/it-this-the-correct-way-of-extending-eslint-rules#50370083. Так же момент выбора расширения файла .eslintrc он упал на js и бо мы получаем все тоже самое что в json, но огромный плюс js формата что мы можем использовать перемене из env файла, это здорово может помочь при CI/CD flow. Также из интересного есть правила импорта для библиотеки material-ui  no-restricted-imports. Это правило позволяет уменьшить размер bundle при сборке если вы используете material, более подробно можно ознакомится здесь https://mui.com/material-ui/guides/minimizing-bundle-size. Ещё можно сказать что важна связка eslint и наших jsconfig.json или tsconfig.json которую мы устанавливаем в этих файлах для eslint мы должны установить в поле parserOptions => project наш путь к проекту ( jsconfig.json или tsconfig.json ). А соответственно в файлах конфига установить в поле include наш .eslintrc.js, это все есть в файлах которые я оставил. На этом думаю с eslintrc закончим.

 ------------------------
### Третий пункт это pre-commit файл в папке .husky

Если вы не понимаете о чем речь то следующие пару предложенией для вас, если вы понимаете о чем речь можете перейти к абзацу ниже. И так Husky это инструмент который позволяет задействовать хуки Git. Это означает, что у вас появляется возможность выполнять некие действия перед выполнением коммита или перед отправкой кода в репозиторий. Основные действия которые обычно делают это запуск всех тестов, проверка файлов через eslint. Но я добавил ещё парочку интересных и полезных. 

#### В моей конфиге husky есть 4 функции:
run_linter - мы проверяем наш код через линтер с помощью lint-staged
\
check_branch - проверяем ветку в которой мы делаем commit
\
no_console - проверяем файлы на наличия console.log
\
no_debugger - проверяем файлы на наличия debugger

Сейчас более подробно пройдемся по каждой из них

run_linter - как я уже говорил здесь мы используем lint-staged который помогает нам проверять наш код через линтер только по тем файлам которые были изменены, это очень важно для скорости разработки. Если у вас в репозитории будет больше 1000 файлом то проверка по каждому в сумме может занять 5 минут времени что согласитесь звучит не круто. В функции run_linter прописан сценарий, если команда lint-staged обнаружила ошибку мы выходим с кодом ошибки 1, что останавливает наш коммит. 

lint-staged - мы должны установить как зависимость в наш проект и так-же добавить конфигурацию в package.json, её вы найдете в приложенных файлах 

check_branch - функции которая как по мне очень важная так как проверяет названия ветки с которой мы производим коммит, в моей конфигурации указаны такие названия как:
1. master
2. main
3. development

Функция проверяет если мы находимся на этой ветке, выводит сообщения на экран что мы хотим сделать коммит на этой ветке, 'вы уверены?'. Мы можем ответить y \ n, если мы отвечаем yes то мы переходим в следующую функцию, если not то мы выходим с кодом ошибки 1, что останавливает наш коммит. 
Вы можете как добавить так и убрать названия веток.


no_debugger - делает простое но очень важное дело, так как у нас в конфиге eslint debugger стоит как warning а не error чтобы не мешать процеcсу разработки то мы можем случайно забыть убрать debugger из кода. Также эта функция выводит названия файлов где нашла debugger. Если эта функция нашла файл с debugger у нас возникает аналогичный вопрос с check_branch где мы можем ответить y \ n, чтобы продолжить или отменить коммит.                             

no_console - делает все тоже самое что no_debugger только для console.log

Важно сказать что эти две функции no_debugger и no_console срабатывают у вас на комите когда вы добавляете файл pre-commit в ваш проект они затригирятся сами на себя, не бойтесь если эта ошибка вылезла только для файла pre-commit смело нажимайте продолжить. Это будет только первый раз при добавлении          

На этом краткий обзор конфига подошел к концу, ниже описаны действия которые помогут с нуля воссоздать конфиг у себя  

 ------------------------
### Все команды для зависимостей prettierrc и eslint лежат в файле commands
 ------------------------

### Чтобы воссоздать конфиг вам нужно:
  1. Скопировать мой файл .prettierrc в ваш репозиторий если у вас такого нету и так же установить prettier как зависимость в ваш репозиторий 
  2. Зайти в свой репозиторий и написать следующую команду для создания .eslintrc.js 
     \
     `npm init @eslint/config` || `yarn create @eslint/config`
  3. Дольше вам нужно будет выбрать:
    \
    3.1 > To check syntax, find problems, and enforce code style
    \
    3.2 > JavaScript modules (import/export)
    \
    3.3 > React
    \
    3.4 > Потом указать если в вышем проекте Typescript
    \
    3.5 > Browser
    \
    3.6 > Use a popular style guide
    \
    3.7 > Airbnb
    \
    3.8 > js
    \
    3.9 > Yes
    \
   Мы это делаем для того чтобы установить расширения Airbnb в наш репозиторий 
  4. После этого добавть мои расширения, плагины, правила для eslint  
  5. Если у вас уже есть husky то можете просто заменить свой файл моим.
     \ 
     Если нету убедитесь что у вас добавлен Git в ваш репозиторий и пропишите следующую команду 
     \
     `npx husky-init && npm install || npx husky-init && yarn`
  6. И добавте следующие строки в файл package.json в поле scripts
    \
    `
    "lint": "eslint ./src --ext .js,.jsx", || "lint": "eslint ./src --ext .ts,.tsx",
    `
    \
    `
    "lint:fix": "eslint ./src --ext .js,.jsx --fix", || "lint:fix": "eslint ./src --ext .ts,.tsx --fix",
    `
    
  7. Так же нужно добавить после scripts в package.json
  ```
  "lint-staged": {
    "src/**/*.{js,jsx,ts,tsx}": [
      "prettier --write",
      "eslint --fix"
     ]
    }, 
  ```
     
  Приятного пользования 🥳
  
  Мой LinkedIn - https://www.linkedin.com/in/danil-kasianenko/ 
